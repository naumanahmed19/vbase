var Vbase=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,o,s,i){try{var a=e[s](i),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,s=[],i=!0,a=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(s.push(n.value),!t||s.length!==t);i=!0);}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}return s}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t,r,n,o,s,i,a,c,l){"boolean"!=typeof i&&(c=a,a=i,i=!1);const u="function"==typeof r?r.options:r;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),n&&(u._scopeId=n),s?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=d):t&&(d=i?function(e){t.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),d)if(u.functional){const e=u.render;u.render=function(t,r){return d.call(r),e(t,r)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return r}var s=o({render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"baseform",class:e.labelClass},[r("el-form",{ref:"form",class:e.formClass,attrs:{"label-width":"100%",model:e.form,"label-position":"top",rules:e.formRules,disabled:e.disabled,size:"small"}},[e.networkError?r("el-alert",{staticClass:"my-4",attrs:{title:e.$t("common.msgs.err_network"),type:"error","show-icon":""}}):e._e(),e._v(" "),e.showErrors&&e.validationErors.length>0?r("el-alert",{attrs:{title:"Please fix validation errors",type:"error","show-icon":""}},[r("ul",{staticClass:"p-0"},e._l(e.validationErors.slice().reverse(),(function(t){return r("li",{key:t},[e._v("\n          "+e._s(t)+"\n        ")])})),0)]):e._e(),e._v(" "),e._t("default"),e._v(" "),e.hasActions?e._t("actions"):r("div",{staticClass:"ml-auto mt-3"},[r("el-button",{class:e.btnClass,attrs:{type:"primary",mini:"",plain:"",loading:e.loadingSave,disabled:e.loadingSave},on:{click:function(t){return e.handleSave()}}},[e._v("\n        "+e._s(e.$t(e.submitBtnLabel))+"\n      ")])],1)],2)],1)},staticRenderFns:[]},undefined,{name:"VbaseSample",props:{form:{type:Object,required:!0},editMode:{type:Boolean,default:!1},updateMethod:{type:String,default:"patch"},url:{type:String,default:""},updateUrl:{type:String,default:""},labelPosition:{type:String,default:"top"},disabled:{type:Boolean,default:!1},beforeSave:{type:Function,default:function(e){return e}},toastErrors:{type:Boolean,default:!1},showErrors:{type:Boolean,default:!1},errors:{type:Function,default:function(){}},disableUrlGen:{type:Boolean,default:!1},submitBtnLabel:{type:String,default:"common.action.save"},successPostMessage:{type:String,default:"common.msgs.post"},successUpdateMessage:{type:String,default:"common.msgs.update"},hasSidebarForm:{type:Boolean,default:!1},btnClass:{type:String,default:""},formClass:{type:String,default:"capte__form"},rules:{type:Object,default:function(){}}},data:function(){return{loadingSave:!1,editWatchers:[],edited:{},validationErors:[],editing:!1,networkError:!1,formRules:{}}},computed:{labelClass:function(){return{"baseform--top":"top"==this.labelPosition,"baseform--left":"left"==this.labelPosition,"baseform--right":"right"==this.labelPosition}},hasActions:function(){return!!this.$slots.actions}},watch:{form:{handler:function(){var e=this;this.$refs.form&&(Object.keys(this.formRules).forEach((function(t){e.form[t]&&delete e.formRules[t]})),this.$refs.form.validate())},deep:!0,immediate:!0},editMode:{handler:function(e){this.editing=e,e?this.registerWatchers():this.destroyWatchers(),this.edited={}},immediate:!0},editing:{handler:function(e){e?this.registerWatchers():this.destroyWatchers(),this.edited={}},immediate:!0}},mounted:function(){var e=this;this.$events.on("editItem",(function(t){e.editing=!1,e.reset(),e.$nextTick((function(){Object.assign(e.form,t),e.editing=!0,e.$emit("afterFormDataLoaded")}))})),this.$events.on("createItem",(function(){e.editing=!1,e.reset()})),this.$events.on("resetBaseForm",(function(){e.reset()})),Object.assign(this.formRules,this.rules)},methods:{patchURL:function(){var e=this.url;return this.updateUrl?e=this.updateUrl:this.form.id&&!this.disableUrlGen&&(e="".concat(e,"/").concat(this.form.id)),e},clearValidation:function(){this.$refs.form.clearValidate()},destroyWatchers:function(){this.editWatchers.map((function(e){return e()})),this.editWatchers=[]},closeSidebar:function(){this.hasSidebarForm&&this.$events.fire("closeit")},patch:function(){var e=this;return this.clearValidation(),this.$http.patch(this.patchURL(),this.beforeSave(this.edited),{headers:{"Content-Type":" application/merge-patch+json"}}).then((function(){e.edited={},e.$message.success(e.$t(e.successUpdateMessage)),e.$emit("success-update"),e.closeSidebar()})).catch((function(t){e.$emit("errors",t.response.data.errors),"422"==t.response.status?(e.validate(t.response.data.errors),e.form.errors=t.response.data.errors):(e.$message.error(e.$t("common.msgs.error")),e.networkError=!0)}))},put:function(){var e=this;return this.clearValidation(),this.$http.put(this.patchURL(),this.beforeSave(this.form),{headers:{"Content-Type":" application/json"}}).then((function(){e.$message.success(e.$t(e.successUpdateMessage)),e.$emit("success-update"),e.closeSidebar()})).catch((function(t){e.$emit("errors",t.response.data.errors),"422"==t.response.status?e.validate(t.response.data.errors):(e.$message.error(e.$t("common.msgs.error")),e.networkError=!0)}))},reset:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$nextTick((function(){void 0!==e.$refs[t]&&e.$refs[t].resetFields()}))},registerWatchers:function(){for(var t in this.form)if("object"===e(this.form[t])&&-1!=["lifecycle"].indexOf(t))for(var r in this.form[t])this.registerWatcher("".concat(t,".").concat(r));else this.registerWatcher(t)},registerWatcher:function(e){this.editWatchers.push(this.$watch("form.".concat(e),(function(t){var r=e.split(".");2==r.length?(r[0]in this.edited||(this.edited[r[0]]={}),this.edited[r[0]][r[1]]=t):1==r.length&&(this.edited[r[0]]="string"==typeof t?""!==t.trim()?t:null:t)}),{deep:!0,immediate:!0}))},scrollToError:function(){document.querySelectorAll(".is-error").length&&document.querySelectorAll(".is-error")[0].scrollIntoView({behavior:"smooth"})},store:function(){var e=this;return this.clearValidation(),this.$http.post(this.url,this.beforeSave(this.form)).then((function(t){e.$message.success(e.$t(e.successPostMessage)),e.$emit("success-save",t.data),e.closeSidebar()})).catch((function(t){e.$emit("errors",t.response.data.errors),"422"==t.response.status?(e.validate(t.response.data.errors),e.toastErrors&&e.errorToast(t.response.data.errors)):e.networkError=!0}))},errorToast:function(e){var t;Object.keys(e).forEach((function(r){t=e[r].join()})),this.$message.warning(t)},validationErrors:function(e){var t,r=this;this.validationErors=[],Object.keys(e).forEach((function(n){t=e[n].join(),r.validationErors.push(t)}))},validate:function(e){var t=this,r={};for(var n in e)r[n]=e[n].map((function(e){return{validator:function(t,r,n){return n(new Error(e))},trigger:"blur",required:!0}}));this.formRules=r,this.showErrors&&this.validationErrors(e),this.$nextTick((function(){return t.scrollToError()}))},handleSave:function(){var e,r=this;return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.networkError=!1,r.loadingSave=!0,!r.url){e.next=17;break}if(!r.editMode&&!r.editing){e.next=13;break}if("put"!==r.updateMethod){e.next=9;break}return e.next=7,r.put();case 7:e.next=11;break;case 9:return e.next=11,r.patch();case 11:e.next=15;break;case 13:return e.next=15,r.store();case 15:e.next=18;break;case 17:r.$emit("click-button");case 18:r.loadingSave=!1;case 19:case"end":return e.stop()}}),e)})),function(){var r=this,n=arguments;return new Promise((function(o,s){var i=e.apply(r,n);function a(e){t(i,o,s,a,c,"next",e)}function c(e){t(i,o,s,a,c,"throw",e)}a(void 0)}))})()}}},undefined,false,undefined,!1,void 0,void 0,void 0),i=Object.freeze({__proto__:null,BaseForm:s}),a=function(e){Object.entries(i).forEach((function(t){var n=r(t,2),o=n[0],s=n[1];e.component(o,s)}))},c=Object.freeze({__proto__:null,default:a,BaseForm:s});return Object.entries(c).forEach((function(e){var t=r(e,2),n=t[0],o=t[1];"default"!==n&&(a[n]=o)})),a}();